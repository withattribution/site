<div class="grid" ng-controller="GridCtrl">
    <div ng-if="show" class="overlay"> 
    <button ng-click="setShown()" type="button" class="overlay-close"></button>
    <ul rn-carousel class="image" 
        rn-carousel-buffered="true" 
        rn-carousel-index="grid.slideIndex">
      <li ng-repeat="item in grid.tumblrPosts">
        <div class="layer">

          <img ng-if="item.type === 'photo'" 
               class="large-backdrop" 
               ng-src="{{ item.fullsize_photo_url || item.mobile_photo_url }}">

          <videogular ng-if="item.type === 'video'" 
                      vg-player-ready="onPlayerReady" 
                      vg-complete="onCompleteVideo" 
                      vg-update-time="onUpdateTime" 
                      vg-update-size="onUpdateSize" 
                      vg-update-volume="onUpdateVolume" 
                      vg-update-state="onUpdateState" 
                      vg-theme="config.theme.url" 
                      vg-autoplay="config.autoPlay" 
                      vg-stretch="config.stretch.value" 
                      vg-responsive="true">

            <video preload='metadata'>
              <source  ng-src="{{item.video_url}}" type="video/mp4">
            </video>

            <vg-poster-image vg-url='item.thumbnail_url' vg-stretch="config.stretch.value"></vg-poster-image>
            <vg-buffering></vg-buffering>
            <vg-overlay-play vg-play-icon="config.theme.playIcon"></vg-overlay-play>
          </videogular>

        </div>
        <p class="caption">{{ item.caption }}</p>
      </li>
    </ul>
      <span class="aok-carousel-control aok-carousel-control-prev" ng-if="grid.slideIndex > 0" ng-click="prev()"></span>
      <span class="aok-carousel-control aok-carousel-control-next" ng-if="grid.slideIndex < grid.tumblrPosts.length - 1" ng-click="next()"></span>
  </div>
  <div class="masonry" 
      masonry column-width=".grid-sizer" 
      item-selector=".item" 
      infinite-scroll="addTumblrPosts()" 
      infinite-scroll-distance="1" 
      infinite-scroll-immediate-check='true'>
    <div masonry-brick class="item" ng-repeat="item in grid.tumblrPosts">
       <div ng-click="setShown($index)">
        <img ng-src="{{ item.type === 'photo' ? item.mobile_photo_url : item.thumbnail_url }}" alt="an aok {{item.type}}">
      </div>
    </div>
  </div>

</div>
